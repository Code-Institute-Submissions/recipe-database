{% extends 'base.html'%} {% block content %}

<h1>Edit {{recipe.recipe_title}}</h1>
    
<p>Fields marked with an asterisk are required</p>
    
<form action="{{ url_for('submit_changes', recipe_id=recipe._id) }}" method="POST" class="col s12">
                    
    <!--The recipe's title, author, image location and category-->
    <div class="row">
                        
        <!--The recipe's title-->
        <div class="input-field col s12 m6 l4">
            <input id="recipe_title" name="recipe_title" type="text" class="validate" value="{{recipe.recipe_title}}" required>
            <label for="recipe_title">Recipe Title*</label>
        </div>
                        
        <!--The recipe's author-->
        <div class="input-field col s12 m6 l2">
            <input id="author" name="author" type="text" class="validate" value="{{recipe.author}}">
            <label for="author">Author</label>
        </div>
                        
        <!--The location of the recipe's illustration-->
        <div class="input-field col s12 m6 l4">
            <input id="image_path" name="image_path" type="text" class="validate" value="{{recipe.image_path}}">
            <label for="image_path">URL of Image (please don't hotlink)</label>
        </div>
                        
        <!--The recipe's category-->
        <div class="input-field col s12 m6 l2">
            <select id="category" name="category_name">
                <option value="" disabled>Click to Select</option>
                {% for cat in categories %}
                    <option value="{{cat.category_name}}"
                        {% if cat.category_name == recipe.category_name %} selected {% endif %}
                        >{{cat.category_name}}</option>
                {% endfor %}
            </select>
            <label>Category*</label>
        </div>
                        
    </div> <!--End of title, author and category row-->
                    
    <!--Country of origin and dietary restrictions-->    
    <div class="row"> 
                        
        <!--The recipe's country of origin-->
        <div class="input-field col s12 m6 l3">
            <input id="origin" name="origin" type="text" class="validate" value="{{recipe.origin}}">
            <label for="origin">Country of Origin</label>
        </div>
                        
        <!--Allergens-->
        <div class="input-field col s12 m6 l3">
            <select multiple id="allergens" name="allergens">
                <option value="" disabled selected>Click to Select</option>
                {% for allergen in allergens %}
                <option value="{{allergen.allergen_name}}"
                        {% if allergen.allergen_name in recipe.allergens %} selected {% endif %}
                        >{{allergen.allergen_name}}</option>
                {% endfor %}
            </select>
            <label>Allergens:</label>
        </div>
                        
        <!--Selector to indicate if the recipe is suitable for vegetarians-->
        <div class="col s4 l2">
            <div class="switch">
                <label>
                     <!--If a recipe isn't vegetarian, it isn't vegan either-->
                    <input id="vegetarian" name="vegetarian" type="checkbox" 
                    onclick="if (!this.checked) document.getElementById('vegan').checked = false;"
                        {% if recipe.vegetarian %} checked {% endif %}>
                    <span class="lever"></span>
                        Vegetarian
                </label>
            </div> 
        </div> <!--End of vegetarian selector-->
                        
        <!--Selector to indicate if the recipe is suitable for vegans-->
        <div class="col s4 l2">
            <div class="switch">
                <label>
                    <!--If a recipe is vegan, it's also vegetarian-->
                    <input id="vegan" name="vegan" type="checkbox" 
                    onclick="if (this.checked) document.getElementById('vegetarian').checked = true;"
                        {% if recipe.vegan %} checked {% endif %}>
                    <span class="lever"></span>
                    Vegan
                </label>
            </div>
        </div> <!--End of vegan selector-->
                        
        <!--Selector to indicate if the recipe is gluten-free-->
        <div class="col s4 l2">
            <div class="switch">
                <label>
                    <input id="gluten_free" name="gluten_free" type="checkbox" 
                        {% if recipe.gluten_free %} checked {% endif %}>
                    <span class="lever"></span>
                    Gluten-Free
                </label>
            </div>
        </div> <!--End of gluten-free selector-->

    </div> <!--End of country of origin and dietary restrictions-->
     
    <!--Recipe statistics-->
    <div class="row"> 
                        
        <!--The number of servings the recipe makes-->
        <div class="input-field col s12 m6 l3">
            <input id="servings" name="servings" type="text" class="validate" value="{{recipe.servings}}">
            <label for="servings">Number of Servings</label>
        </div>
                        
        <!--The time needed to prepare the ingredients for cooking-->
        <div class="input-field col s12 m6 l3">
            <input id="prep_time" name="prep_time" type="text" class="validate" value="{{recipe.prep_time}}">
            <label for="prep_time">Preparation Time</label>
        </div>
                    
        <!--Additional time-->
        <div class="input-field col s12 m6 l3">
            <input id="extra_time" name="extra_time" type="text" value="{{recipe.extra_time}}" class="validate">
            <label for="extra_time">Extra Time</label>
        </div>
                        
        <!--The time needed to cook the recipe-->
        <div class="input-field col s12 m6 l3">
            <input id="cook_time" name="cook_time" type="text" class="validate" value="{{recipe.cook_time}}">
            <label for="cook_time">Cook Time</label>
        </div>

    </div> <!--End of recipe statistics-->
                    
    <!--Input field for the ingredients-->
    <div class="row">
        <div class="input-field col s12">
            <textarea id="ingredients" name="ingredients" class="materialize-textarea" required>{{recipe.ingredients}}</textarea>
            <label for="ingredients">Ingredients*</label>
        </div>
    </div> <!--End of ingredients-->
                    
    <!--Input field for the method-->
    <div class="row">
        <div class="input-field col s12">
            <textarea id="method" name="method" class="materialize-textarea" required>{{recipe.method}}</textarea>
            <label for="method">Method*</label>
        </div>
    </div> <!--End of method-->
                    
    <!--Buttons to submit or cancel the changes-->
    <div class="row">
                        
        <!--Button to submit the changes-->
        <button class="btn waves-effect waves-light" type="submit" name="action">Save
            <i class="material-icons right">save</i>
        </button>
                        
        <!--Button to cancel the changes and go back to the recipe display page-->
        <a href="{{url_for('show_recipe', recipe_id=recipe._id)}}" class="btn waves-effect waves-light">
            <i class="material-icons right">close</i>Cancel</a>
                    
    </div>  <!--End of buttons-->

</form>  <!--End of recipe input form-->
                
{% endblock %}